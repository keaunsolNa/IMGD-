<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nks.imgd.mapper.article.ArticleCommentMapper">

    <select id="findArticleCommentByIds" resultType="com.nks.imgd.dto.Schema.ArticleComment">
        SELECT ARTICLE_ID
             , COMMENT_ID
          FROM ARTICLE_COMMENT
         WHERE ARTICLE_ID = #{articleId}
           AND COMMENT_ID = #{commentId}
    </select>

    <select id="findArticleCommentById" resultType="com.nks.imgd.dto.Schema.ArticleComment">
        SELECT COMMENT_ID
          FROM ARTICLE_COMMENT
         WHERE ARTICLE_ID = #{articleId}
    </select>

    <select id="findArticleById" resultType="com.nks.imgd.dto.dataDTO.ArticleWithTags">
        SELECT ARTICLE_ID
             , TYPE
             , F_GET_TAG_NM(ARTICLE_ID) TAG_IDS
             , USER_ID
             , F_GET_PICTURE_NM(USER_ID) AS PICTURE_NM
             , F_GET_USER_NM(USER_ID) USER_NM
             , TITLE
             , ARTICLE
             , F_GET_LIKE_CNT(ARTICLE_ID) LIKE_CNT
             , F_GET_COMMENT_CNT(ARTICLE_ID) COMMENT_CNT
             , WATCH_CNT
             , REG_DTM
             , REG_ID
             , MOD_DTM
             , MOD_ID
        FROM ARTICLE
        WHERE ARTICLE_ID = #{articleId}
    </select>

    <insert id="insertArticleComment">
        INSERT
          INTO ARTICLE_COMMENT
        ( ARTICLE_ID
        , COMMENT_ID
        )
          VALUES
        (
          #{article.articleId}
        , #{article.commentId}
        )
    </insert>

    <delete id="deleteArticleComment">
        DELETE
          FROM article_comment
         WHERE ARTICLE_ID = #{articleId}
          AND COMMENT_ID = #{commentId}
    </delete>

</mapper>
